<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html  xmlns:th="http://www.thymeleaf.org">
    <head>
        <!-- Required meta tags -->
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <link rel="canonical" href="https://getbootstrap.com/docs/4.4/examples/carousel/">
        <link href = "https://fonts.googleapis.com/css2? family = Rokkitt & display = swap" rel = "stylesheet">
        <link href = "https://fonts.googleapis.com/css2? family = Caladea: ital @ 1 & display = swap" rel = "stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans|Oswald|PT+Sans" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Alike&family=Great+Vibes&family=Old+Standard+TT:ital@1&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Text:ital@1&display=swap" rel="stylesheet">
        <link rel="stylesheet" th:href="@{/webjars/bootstrap/css/bootstrap.min.css}">
        <link th:href="@{/css/carrousel.css}" rel="stylesheet">
        <link rel="stylesheet" th:href="@{/css/css.css}" type="text/css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.8.2/css/lightbox.min.css">
        <title>Servcios.com</title>
    </head>
    <body>
        <form th:action="@{/buscarPorFiltros}" method="GET"  th:object="${filtro}">
            <header>
                <nav class="navbar navbar-light bg-dark ajustar ">
                    <a th:href="@{/}" class="volver titulobuscadorServicios"><h1 class=" text-right titulo text-success titulobuscador">Servicios.com</h1></a>
                    <div class="form-inline titulobuscador">
                        <input th:if="*{nombre != ''}" class="form-control  mr-sm-2 buscador titulobuscador" name="nombre" th:field="*{nombre}" type="search" aria-label="Search">
                        <input  th:if="*{nombre == ''}" class="form-control  mr-sm-2 buscador titulobuscador" name="nombre"  type="search" placeholder="Busque un Servicio" aria-label="Search">
                        <button class="btn btn-outline-success my-2 my-sm-1 botoncito botonbuscar bservicios" type="submit">Buscar</button>
                    </div>
                    <h1 class=" text-right titulo2 text-success">Servicios.com</h1>
                </nav>
            </header>
            <section class="filtros">
            <!-- Filtros -->
            <div >
                <a class="btn btn-outline-success btn-filtros" data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
                    Filtros
                </a>
                  <a   th:if="${#httpServletRequest.requestURI == '/buscarPorFiltros'} and ${!sinServicios}"  class="btn btn-danger btn-filtros text-light"  role="button" th:href="@{/buscar}">
                    Borrar filtros
                </a>

            </div>
            <div class="container-fluid clearfix contenedor-filtros collapse mt-3" id="collapseExample">
                <div class="row">
                    <div class="col-sm">
                        <div class="ciudades">
                            <div class="col-md-3 mb-3"  >
                                <label for="validationDefault04" class="labelbuscador">Provincia:</label>
                                <select class="custom-select  buscadorciudad " name="provincia" id="listaProvincias"  onclick="mostrarListado()" >
                                    <option selected  value="">No especificar</option>
                                    <option  th:each="provincias: ${provincias}"  th:value="${provincias.id}" th:text="${provincias.nombre}" ></option>
                                </select>
                                <label for="validationDefault04" class="labelbuscador">Departamento:</label>
                                <select class="custom-select buscadorciudad" name="departamento"   id="listaDepartamentos" >
                                    <option selected  value="">No especificar</option>
                                    <script type="text/javascript" th:inline="javascript" charset="UTF-8">
                                        function mostrarListado() {
                                            /* Obtenemos el value de la provincia selecciona*/
                                            var idProvincia = document.getElementById("listaProvincias").value;
                                            var idDepartamento = document.getElementById("listaDepartamentos");
                                            /* El value es un String lo pasamos a un int para que se pueda comparar*/
                                            var idResultado = parseInt(idProvincia);
                                            /* Traemos la lista de deparmentos*/
                                            var departamentos = /*[[${departamentos}]]*/ null;
                                            /* Se limpia la lista de departamentos por si ya hubiera otra lista antes*/
                                            document.getElementById("listaProvincias").addEventListener('change', limpiar, false);
                                            /* Recorremos la lista de departamentos si existe un id =  listaProvincia lo agregamos al select*/
                                            for (var i in departamentos) {
                                                let opcion = document.createElement('option');
                                                if (departamentos[i].id == idResultado) {
                                                    opcion.value = departamentos[i].nombre;
                                                    opcion.text = departamentos[i].nombre;
                                                    idDepartamento.add(opcion);
                                                }
                                            }
                                        }
                                        function limpiar() {
                                            /* Se limpia la lista de departamentos por si ya hubiera otra lista antes*/
                                            var idDepartamento = document.getElementById("listaDepartamentos");
                                            idDepartamento.innerHTML = '<option selected value="">No especificar</option>';
                                        }

                                    </script>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm">
                        <label for="validationDefault04">Horario Disponible:</label>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="horario" id="exampleRadios1" value="Part Time"   >
                            <label class="form-check-label" for="exampleRadios1">
                                Part Time
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="horario" id="exampleRadios2" value="Full Time" >
                            <label class="form-check-label" for="exampleRadios2">
                                Full Time
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="horario" id="exampleRadios3" value="No especificar" checked  >
                            <label class="form-check-label" for="exampleRadios3">
                                No especificar
                            </label>
                        </div>
                    </div>
                    <div class="col-sm">
                        <div class="rangoPrecio">
                            <label for="customRange1">Precio Maximo:</label>
                            <input type="range"  name="rangoPrecio"  class="custom-range"  id="precio" min="0" max="10000" value="0" >
                            $<span class="preFiltro" id="pre">0</span>
                        </div>
                        <div class="form-check rangoSinPrecio">
                            <input class="form-check-input" type="checkbox" value="" id="rangoSinPrecio" >
                            <label class="form-check-label" for="defaultCheck1">
                                No especificar
                            </label>
                        </div>
                    </div>
                </div>
                <button class="btn btn-success botoncito btnfiltros" type="submit">Aplicar</button>
            </div>
            </section>
        </form>


        <!-- Servicios -->

        <div class="container ajustar-lista">
            <div th:if="${!list.isEmpty()}">
                <div th:if="${sinServicios}" class="alert alert-danger text-center fade show mt-4" role="alert">
                    Lo sentimos no se encontraron servicios con los datos ingresados
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <ul th:each="servicio, iStat: ${list}" class="list-group">
                    <li class="list-group">
                        <div class="row">
                            <div class="col-md-25">
                                <div class="card">
                                    <div class="card-header">
                                        <h3 class="text-capitalize"   style="font-family: 'DM Serif Text', serif;" th:text="${servicio.nombre}">Nombre del servicio</h3>
                                    </div>
                                    <table class="table table-stryped">
                                        <thead class="thead-dark">
                                            <tr>
                                                <th>Descripcion:</th>
                                                <th>Datos:</th>
                                                <th>Fotos:</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <article class="text-descripcion" lang="en">
                                                        <p   th:text="${servicio.descripcion}">Descripcion</p>
                                                    </article>
                                                </td>
                                                <td>
                                                    <div class="datos-div">
                                                        <p class="datos-tabla"  th:text="'Email: ' + ${servicio.email}" >email</p>
                                                        <p class="datos-tabla wsp-cel"  th:text="'Celular: ' +${servicio.celular}">Celular</p>
                                                        <p class="datos-tabla"  th:text="'Horario: ' + ${servicio.horario}"> Horario</p>
                                                        <p class="datos-tabla" th:if="${servicio.precio} != null" th:text="'Precio: ' + ${servicio.precio}  + ' ' +${servicio.precioDescripcion}">Precio</p>
                                                        <p class="datos-tabla" th:if="${servicio.precio} == null" th:text="'Precio: '  + ' ' +${servicio.precioDescripcion}">Precio</p>
                                                        <span th:each="usuario, iStat: ${usuarios}"  th:if="${servicio.idUsuario} == ${usuario.idUsuario} ">
                                                            <p class="datos-tabla text-capitalize" th:text="'Provincia: ' + ${usuario.provincia}">Provincia</p><p class="datos-tabla text-capitalize"  th:text="'Departamento: ' + ${usuario.departamento}">Departamento</p>
                                                            <p class="datos-tabla text-capitalize" th:text="'Usuario: ' + ${usuario.nombre} + ' ' + ${usuario.apellido}">Usuario</p>
                                                        </span>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div th:id="'carrusel'+${iStat.index}" class="carousel slide slider-principal clearfix " data-ride="carousell" data-interval="false"  >
                                                        <div class="carousel-inner clearfix" >
                                                            <div  th:each="file, iterstat : ${servicio.filess}"  class="carousel-item  slider" th:class="${iterstat.index}!=0 ? 'carousel-item slider':'carousel-item slider active'">
                                                                <a th:href="*{'data:image/jpg;base64,' + file.url}" th:data-lightbox="'photos'+${iStat.index}" class="img-slider"><img th:src="*{'data:image/jpg;base64,'+ file.url}" class="d-block " th:alt="${servicio.nombre}"></a>
                                                            </div>
                                                        </div>
                                                        <a class="carousel-control-prev" th:href="'#carrusel'+${iStat.index}" role="button" data-slide="prev">
                                                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                                            <span class="sr-only">Previous</span>
                                                        </a>
                                                        <a class="carousel-control-next" th:href="'#carrusel'+${iStat.index}" role="button" data-slide="next">
                                                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                                            <span class="sr-only">Next</span>
                                                        </a>
                                                        <p class="text-secondary text-center mb-0">click en el centro de la imagen para ampliar</p>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>

        <nav aria-label="Page navigation example" class="ajustar-paginas">
            <ul class="pagination justify-content-center">
                <li class="page-item" th:classappend="${prev == 0 ? 'disabled': ''}">
                    <a th:if="${#httpServletRequest.requestURI == '/buscar'}"  class="page-link" th:href="@{|/buscar?page=${prev}|}">Anterior</a>
                    <a th:if="${#httpServletRequest.requestURI == '/buscarPorNombre'}"  class="page-link" th:href="@{|/buscarPorNombre?nombre=${filtro.nombre}(page=${prev})}">Anterior</a>
                    <a th:if="${#httpServletRequest.requestURI == '/buscarPorFiltros'}"  class="page-link" th:href="@{|/buscarPorNombre?nombre=${filtro.nombre}(page=${prev})}">Anterior</a>
                </li>
                <li class="page-item" th:each="page : ${pages}" th:classappend="${current == page ? 'active': ''}">
                    <a th:if="${#httpServletRequest.requestURI == '/buscar'}"class="page-link" th:href="@{|/buscar?page=${page}|}" th:text="${page}"></a>
                    <a th:if="${#httpServletRequest.requestURI == '/buscarPorNombre'}"class="page-link" th:href="@{|/buscarPorNombre?nombre=${filtro.nombre}(page=${page})}" th:text="${page}"></a>
                    <a th:if="${#httpServletRequest.requestURI == '/buscarPorFiltros'}"class="page-link" th:href="@{|/buscarPorNombre?nombre=${filtro.nombre}(page=${page})}" th:text="${page}"></a>
                </li>
                <li  class="page-item" th:classappend="${current == last ? 'disabled': ''}">
                    <a  th:if="${#httpServletRequest.requestURI == '/buscar'}" class="page-link" th:href="@{|/buscar?page=${next}|}">Siguiente</a>
                    <a  th:if="${#httpServletRequest.requestURI == '/buscarPorNombre'}" class="page-link" th:href="@{|/buscarPorNombre?nombre=${filtro.nombre}(page=${next})}">Siguiente</a>
                    <a  th:if="${#httpServletRequest.requestURI == '/buscarPorFiltros'}" class="page-link" th:href="@{|/buscarPorNombre?nombre=${filtro.nombre}(page=${next})}">Siguiente</a>
                </li>
            </ul>
        </nav>

        <footer class="page-footer font-small blue footerBuscador">
            <!-- Copyright -->
            <div class="footer-copyright text-center py-3 ">© 2020 Copyright:
                <a th:href="@{/}" class="text-success"> Servicios.com</a>
            </div>
            <!-- Copyright -->
        </footer>
        <!-- Footer -->
        <script th:src="@{/webjars/jquery/jquery.min.js}"></script>
        <script th:src="@{/webjars/popper.js/umd/popper.min.js}"></script>
        <script th:src="@{/webjars/bootstrap/js/bootstrap.min.js}"></script>
        <script type="text/javascript" th:src="@{/js/js.js}"></script>
        <script src="https://kit.fontawesome.com/9c123ffe91.js" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.8.2/js/lightbox.min.js"></script>
    </body>
</html>

<!--  

      <div class="row">
                    <div class="col-md-2"></div>
                    <div class="col-md-8">
                        <nav arial-label = "Pagination" >
                            <ul class=" pagination justify-content-center">
                                <li class="page-item" th:each="page: ${pages}"  >
                                    <a class="page-ling" th:href="@{|/?page=${page}|}" th:text="${page}"></a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                      <div class="col-md-2"></div>
                    </div>
-->