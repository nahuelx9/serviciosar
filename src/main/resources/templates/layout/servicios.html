<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
    <head th:fragment="head">
    <head>
        <title>header y filtros</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body>
        <section th:fragment="headerAndFilters" >
            <form th:action="@{/buscarPorFiltros}" method="GET"  th:object="${filtro}">
            <header>
                <nav class="navbar navbar-light bg-dark" id="nav-lista">
                    <a th:href="@{/}" class="volver "><h1 class=" text-right titulo text-success titulobuscador">Servicios.com</h1></a>
                    <div class="form-inline">
                        <input id="mensaje"  th:if="*{nombre != ''}" class="form-control mr-sm-2" name="nombre" th:field="*{nombre}" type="search" aria-label="Search"  >
                        <input   id="mensaje"  th:if="*{nombre == ''}" class="form-control mr-sm-2" name="nombre"  type="search" placeholder="Busque un Servicio" aria-label="Search"  >
                        <button class="btn btn-outline-success my-2 my-sm-1 btn-nav-buscador" type="submit">Buscar</button>
                    </div>
                    <h1 class="titulo text-success">Servicios.com</h1>
                </nav>
            </header>
            <section class="filtros">
                <!-- Filtros -->
                <div >
                    <a class="btn btn-outline-success btn-filtros " data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
                        Filtros
                    </a>
                    <a   th:if="${#httpServletRequest.requestURI == '/buscarPorFiltros'} and ${!sinServicios}"  class="btn btn-danger btn-filtros text-light"  role="button" th:href="@{/buscar}">
                        Borrar filtros
                    </a>
                </div>
                <div class="container-fluid clearfix contenedor-filtros mt-3 collapse"  id="collapseExample">
                    <div class="d-flex justify-content-between mt-2 ml-4 mr-4 font-italic" id="contenedor-filtros">
                        <div class=" mb-4 locaclidad">
                            <label for="validationDefault04" class="labelbuscador">Provincia:</label>
                            <select class="custom-select  buscadorciudad " name="provincia" id="listaProvincias"  onclick="mostrarListado()" >
                                <option selected  value="">No especificar</option>
                                <option  th:each="provincias: ${provincias}"  th:value="${provincias.id}" th:text="${provincias.nombre}" ></option>
                            </select>
                            <label for="validationDefault04" class="labelbuscador mt-2">Departamento:</label>
                            <select class="custom-select buscadorciudad" name="departamento"   id="listaDepartamentos" >
                                <option selected  value="">No especificar</option>

                            </select>
                        </div>
                        <div class="mb-4" >
                            <label for="validationDefault04">Horario Disponible:</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="horario" id="exampleRadios1" value="Part Time"   >
                                <label class="form-check-label" for="exampleRadios1">
                                    Part Time
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="horario" id="exampleRadios2" value="Full Time" >
                                <label class="form-check-label" for="exampleRadios2">
                                    Full Time
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="horario" id="exampleRadios3" value="No especificar" checked  >
                                <label class="form-check-label" for="exampleRadios3">
                                    No especificar
                                </label>
                            </div>
                        </div>
                        <div class="precioFiltro">
                            <div class="rangoPrecio">
                                <label for="customRange1">Precio Maximo:</label>
                                <input type="range"  name="rangoPrecio"  class="custom-range"  id="precio" min="0" max="10000" value="0" >
                                $<span class="preFiltro" id="pre">0</span>
                            </div>
                            <div class="form-check rangoSinPrecio">
                                <input class="form-check-input" type="checkbox" value="" id="rangoSinPrecio" >
                                <label class="form-check-label" for="defaultCheck1">
                                    No especificar
                                </label>
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-success  btnfiltros" type="submit">Aplicar</button>
                </div>
            </section>
        </form>
        </section>
        
        <section th:fragment="allServicios" >
        <div class="container ajustar-lista" id="contenedor-card">
            <div th:if="${!list.isEmpty()}">
                <div th:if="${sinServicios}" class="alert alert-danger text-center fade show mt-4" role="alert">
                    Lo sentimos no se encontraron servicios con los datos ingresados
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <ul th:each="servicio, iStat: ${list}" class="list-group">
                    <li class="list-group">
                        <div class="row">
                            <div class="col-md-25">
                                <div class="card">
                                    <div class="card-header">
                                        <h3 class="text-capitalize titulo-servicio"   style="font-family: 'DM Serif Text', serif;" th:text="${servicio.nombre}">Nombre del servicio</h3>
                                    </div>
                                    <table class="table table-stryped">
                                        <thead class="thead-dark">
                                            <tr>
                                                <th class="titulo-card">Descripcion:</th>
                                                <th class="titulo-card">Datos:</th>
                                                <th class="titulo-card">Fotos:</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr id="card-responvie">
                                                <td>
                                                    <h5 class="card-title titulo-card-responsive">Descripcion:</h5>
                                                    <article class="text-justify m-0 descripcion-servicio text-break" lang="en">
                                                        <p   th:text="${servicio.descripcion}">Descripcion</p>
                                                    </article>
                                                </td>
                                                <td>
                                                    <h5 class="card-title titulo-card-responsive">Datos:</h5>
                                                    <div class="datos-div d-flex flex-column bd-highlight" >
                                                        <p class="mb-2 text-break"  th:text="'Email: ' + ${servicio.email}" >email</p>
                                                        <p  class="mb-2 wsp-cel" th:if="${servicio.whatsapp} == true"  th:text="'Celular: ' +${servicio.celular}">Celular</p>
                                                        <p th:if="${servicio.whatsapp}== false"class="mb-2"  th:text="'Celular: ' +${servicio.celular}">Celular</p>
                                                        <p class="mb-2"  th:text="'Horario: ' + ${servicio.horario}"> Horario</p>
                                                        <p class="mb-2" th:if="${servicio.precio} != null" th:text="'Precio: ' + '$'+ ${servicio.precio}  + ' ' +${servicio.precioDescripcion}">Precio</p>
                                                        <p class="mb-2" th:if="${servicio.precio} == null" th:text="'Precio: '  + ' ' +${servicio.precioDescripcion}">Precio</p>
                                                        <span th:each="usuario, iStat: ${usuarios}"  th:if="${servicio.idUsuario} == ${usuario.idUsuario} ">
                                                            <p class="mb-2 text-capitalize" th:text="'Provincia: ' + ${usuario.provincia}">Provincia</p><p class="datos-tabla text-capitalize" th:text="'Departamento: ' + ${usuario.departamento}" >Departamento</p>
                                                            <p class="mb-2 text-capitalize text-break" th:text="'Usuario: ' + ${usuario.nombre} + ' ' + ${usuario.apellido}">Usuario</p>
                                                        </span>
                                                    </div>
                                                </td>
                                                <td>
                                                    <h5 class="card-title titulo-card-responsive">Fotos:</h5>
                                                    <div th:id="'carrusel'+${iStat.index}" class="carousel  m-0  " data-ride="carousell" data-interval="false"  >
                                                        <div class="carousel-inner clearfix">
                                                            <div  th:each="file, iterstat : ${servicio.filess}"  class="carousel-item  slider" th:class="${iterstat.index}!=0 ? 'carousel-item slider':'carousel-item slider active'">
                                                                <a th:href="*{'data:image/jpg;base64,' + file.url}" th:data-lightbox="'photos'+${iStat.index}" class="img-slider"><img th:src="*{'data:image/jpg;base64,'+ file.url}" class="d-block " alt="..."></a>
                                                            </div>
                                                        </div>
                                                        <a class="carousel-control-prev" th:href="'#carrusel'+${iStat.index}" role="button" data-slide="prev">
                                                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                                            <span class="sr-only">Previous</span>
                                                        </a>
                                                        <a class="carousel-control-next" th:href="'#carrusel'+${iStat.index}" role="button" data-slide="next">
                                                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                                            <span class="sr-only">Next</span>
                                                        </a>
                                                        <p class="text-secondary text-center mb-0">click en el centro de la imagen para ampliar</p>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
        </section>
        <section th:fragment="pagination" >
             <nav aria-label="Page navigation example">
            <ul class="pagination justify-content-center">
                <li class="page-item" th:classappend="${prev == 0 ? 'disabled': ''}">
                    <a th:if="${#httpServletRequest.requestURI == '/buscar'}"  class="page-link" th:href="@{|/buscar?page=${prev}|}">Anterior</a>
                    <a th:if="${#httpServletRequest.requestURI == '/buscarPorNombre'}"  class="page-link" th:href="@{|/buscarPorNombre?nombre=${filtro.nombre}(page=${prev})}">Anterior</a>
                    <a th:if="${#httpServletRequest.requestURI == '/buscarPorFiltros'}"  class="page-link" th:href="@{|/buscarPorNombre?nombre=${filtro.nombre}(page=${prev})}">Anterior</a>
                </li>
                <li class="page-item" th:each="page : ${pages}" th:classappend="${current == page ? 'active': ''}">
                    <a th:if="${#httpServletRequest.requestURI == '/buscar'}"class="page-link" th:href="@{|/buscar?page=${page}|}" th:text="${page}"></a>
                    <a th:if="${#httpServletRequest.requestURI == '/buscarPorNombre'}"class="page-link" th:href="@{|/buscarPorNombre?nombre=${filtro.nombre}(page=${page})}" th:text="${page}"></a>
                    <a th:if="${#httpServletRequest.requestURI == '/buscarPorFiltros'}"class="page-link" th:href="@{|/buscarPorNombre?nombre=${filtro.nombre}(page=${page})}" th:text="${page}"></a>
                </li>
                <li  class="page-item" th:classappend="${current == last ? 'disabled': ''}">
                    <a  th:if="${#httpServletRequest.requestURI == '/buscar'}" class="page-link" th:href="@{|/buscar?page=${next}|}">Siguiente</a>
                    <a  th:if="${#httpServletRequest.requestURI == '/buscarPorNombre'}" class="page-link" th:href="@{|/buscarPorNombre?nombre=${filtro.nombre}(page=${next})}">Siguiente</a>
                    <a  th:if="${#httpServletRequest.requestURI == '/buscarPorFiltros'}" class="page-link" th:href="@{|/buscarPorNombre?nombre=${filtro.nombre}(page=${next})}">Siguiente</a>
                </li>
            </ul>
        </nav>
        </section>
    </body>
</html>
